<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Introduction à Angular2</title>
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="//sylvain.pontoreau.com/themes/Casper/favicon.ico">

    <link rel="stylesheet" type="text/css" href="//sylvain.pontoreau.com/themes/Casper/assets/css/screen.css?v=1.0.0" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />

    <link rel="canonical" href="http://sylvain.pontoreau.com/2015/11/16/Introduction-a-Angular2.html" />
    
    <meta property="og:site_name" content="Sylvain PONTOREAU" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Introduction à Angular2" />
    <meta property="og:description" content="L&amp;#8217;annonce d&#x27;Angular2 l&amp;#8217;année dernière à la ng-europe à fait couler beaucoup d&amp;#8217;encre. Cette nouvelle version change complètement le framework, a tel point que l&amp;#8217;on peut se demander si la librairie ne devrait..." />
    <meta property="og:url" content="http://sylvain.pontoreau.com/2015/11/16/Introduction-a-Angular2.html" />
    <meta property="og:image" content="http://sylvain.pontoreau.com/images/introduction-a-angular2.png" />
    <meta property="article:published_time" content="2015-11-15T23:00:00.000Z" />
    <meta property="article:modified_time" content="2016-06-12T20:50:03.951Z" />
    <meta property="article:tag" content="Angular2" />
    <meta property="article:tag" content="TypeScript" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Introduction à Angular2" />
    <meta name="twitter:description" content="L&amp;#8217;annonce d&#x27;Angular2 l&amp;#8217;année dernière à la ng-europe à fait couler beaucoup d&amp;#8217;encre. Cette nouvelle version change complètement le framework, a tel point que l&amp;#8217;on peut se demander si la librairie ne devrait..." />
    <meta name="twitter:url" content="http://sylvain.pontoreau.com/2015/11/16/Introduction-a-Angular2.html" />
    <meta name="twitter:image:src" content="http://sylvain.pontoreau.com/images/introduction-a-angular2.png" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "Sylvain PONTOREAU",
    "author": {
        "@type": "Person",
        "name": "Sylvain PONTOREAU",
        "image": "https://avatars.githubusercontent.com/u/3357643?v=3",
        "url": "undefined/author/undefined",
        "sameAs": "sylvain.pontoreau.com"
    },
    "headline": "Introduction à Angular2",
    "url": "http://sylvain.pontoreau.com/2015/11/16/Introduction-a-Angular2.html",
    "datePublished": "2015-11-15T23:00:00.000Z",
    "dateModified": "2016-06-12T20:50:03.951Z",
    "image": "http://sylvain.pontoreau.com/images/introduction-a-angular2.png",
    "keywords": "Angular2,  TypeScript",
    "description": "L&amp;#8217;annonce d&#x27;Angular2 l&amp;#8217;année dernière à la ng-europe à fait couler beaucoup d&amp;#8217;encre. Cette nouvelle version change complètement le framework, a tel point que l&amp;#8217;on peut se demander si la librairie ne devrait..."
}
    </script>

    <meta name="generator" content="Ghost ?" />
    <link rel="alternate" type="application/rss+xml" title="Sylvain PONTOREAU" href="http://sylvain.pontoreau.com/rss" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/default.min.css">
</head>
<body class="post-template tag-Angular2 tag-TypeScript">

    


<header class="main-header post-head " style="background-image: url(http://sylvain.pontoreau.com/images/introduction-a-angular2.png)">
    <nav class="main-nav overlay clearfix">
        <a class="back-button icon-arrow-left" href="http://sylvain.pontoreau.com">Home</a>
        <!-- <a class="subscribe-button icon-feed" href="http://sylvain.pontoreau.com/rss/">Subscribe</a> -->
    </nav>
</header>

<main class="content" role="main">

    <article class="post tag-Angular2 tag-TypeScript">

        <header class="post-header">
            <h1 class="post-title">Introduction à Angular2</h1>
            <section class="post-meta">
                <time class="post-date" datetime="2015-11-16">16 November 2015</time>  on <a href="http://sylvain.pontoreau.com/tag/Angular2">Angular2</a>, <a href="http://sylvain.pontoreau.com/tag/TypeScript"> TypeScript</a>
            </section>
        </header>

        <section class="post-content">
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>L&#8217;annonce d'<strong>Angular2</strong> l&#8217;année dernière à la <em>ng-europe</em> à fait couler beaucoup d&#8217;encre. Cette nouvelle version change complètement le framework, a tel point que l&#8217;on peut se demander si la librairie ne devrait pas s&#8217;appeler autrement. Dernièrement j&#8217;ai eu un peu de temps pour faire de la veille et ça faisait un moment que je voulais voir ce que cette version donne. Je vous propose donc un petit exemple !</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rest_api">Rest API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Afin de gagner du temps, j&#8217;ai créé un Repo sur <strong>Github</strong> contenant une API Rest très simple à utiliser. Commencez par récupérer le projet ici :</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/Vtek/BlogIntroductionAngular2" class="bare">https://github.com/Vtek/BlogIntroductionAngular2</a></p>
</div>
<div class="paragraph">
<p>L&#8217;Api tourne avec <strong>node.js</strong> (vous trouverez le runtime <a href="https://nodejs.org">ici</a>), et nécessite la CLI <strong>TypeScript</strong>. Il faut l&#8217;installer globalement via npm :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">$ npm install -g typescript</code></pre>
</div>
</div>
<div class="paragraph">
<p>TypeScript utilise des fichiers de définitions. Pour les gérer éfficacement j&#8217;utilise la CLI <strong>tsd</strong> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">$ npm install -g tsd</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pour compiler les fichiers TypeScript, mettez vous à la racine du projet et tapez les trois commandes suivantes :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">$ npm install
$ tsd install
$ tsc</code></pre>
</div>
</div>
<div class="paragraph">
<p>Si tout va bien l&#8217;API démarre via la commande :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">$ npm start</code></pre>
</div>
</div>
<div class="paragraph">
<p>Le serveur écoute sur le port 3000 et si vous attaquez l&#8217;url <a href="http://localhost:3000/user" class="bare">http://localhost:3000/user</a>, vous devriez obtenir le <strong>JSON</strong> suivant en réponse :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">[
    {"firstName":"Sylvain","lastName":"PONTOREAU"},
    {"firstName":"Guillaume","lastName":"SPERA"},
    {"firstName":"Aroua","lastName":"TOUKABRI"},
    {"firstName":"Anthony","lastName":"GUILLAUME"}
]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_angular2_et_les_services">Angular2 et les services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Si vous avez déjà fait de l&#8217;Angular, vous connaissez très certainement les <em>services</em>. C&#8217;est une des notions qui a été conservée dans la version 2 et nous allons en utiliser un pour consommer notre Rest API. Pour commencer, ajoutez un répertoire <em>services</em> dans :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">public/javascripts/app</code></pre>
</div>
</div>
<div class="paragraph">
<p>et ajoutez y un fichier <em>user.ts</em> et un <em>user.service.ts</em>. Le fichier user.ts contient le code suivant :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">export class User{
    firstName: string;
    lastName: string;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cette classe définit un objet de données correspondant au JSON qui est renvoyé par l&#8217;API. Le fichier <em>user.service.ts</em> aura pour structure :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">export class UserService {

    constructor(){

    }

    public getUsers() {

    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>La méthode <em>getUser()</em> permettra d&#8217;obtenir les données. Pour consommer l&#8217;API Rest il existe le module <strong>Http</strong>. Celui-ci vous permet d&#8217;attaquer les services web via les principaux verbes Http (<strong>Get</strong>, <strong>Post</strong>, <strong>Put</strong>, <strong>Delete</strong>&#8230;&#8203;). Pour l&#8217;utiliser il faut au préalable en connaitre la définition. De plus, il faut que le service puisse utiliser la classe <em>User</em>. Dans le code source, avant l&#8217;export de la classe <em>UserService</em> il faut donc ajouter les imports :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">import {Http} from 'angular2/http';
import {User} from './user';</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pour manipuler l&#8217;objet <em>Http</em>, ajoutez un attribut de classe au-dessus du constructeur :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">private _http: Http;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Dans <em>getUsers()</em> il est maintenant possible d&#8217;utiliser la référence pour faire l&#8217;appel à l&#8217;API :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">return this._http
           .get('http://localhost:3000/user')
           .map((res) =&gt; { return &lt;User[]&gt;res.json(); });</code></pre>
</div>
</div>
<div class="paragraph">
<p>La méthode <em>get</em> est utilisé pour faire un appel Http Get sur l&#8217;url <a href="http://localhost:3000/user" class="bare">http://localhost:3000/user</a>. C&#8217;est un code fluent (<a href="https://fr.wikipedia.org/wiki/D%C3%A9signation_cha%C3%AEn%C3%A9e">Désignation chaînée</a>), il faut donc chainer sur la méthode <em>map()</em> qui va s&#8217;occuper de transcrire le JSON en objet de type <em>User</em>. Pour le faire on utilise une fonction fléchée (<a href="https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Fonctions/Fonctions_fl%C3%A9ch%C3%A9es">Arrow function</a>) qui renvoie le résultat de la conversion.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Les fonctions fléchées sont normalisées dans <strong>ES6</strong>. Elles sont utilisées depuis longtemps en programmation et on les retrouve souvent sous le nom d'<strong>Expression Lambda</strong>. Cette dénomination vient du travail d'<em>Alonzo Church</em> qui est l&#8217;inventeur de ce concept (<a href="https://fr.wikipedia.org/wiki/Lambda-calcul">λ-calcul</a>). Il est possible de les utiliser dans beaucoup de langages, notamment <strong>C#</strong>, <strong>Lisp</strong>, <strong>Python</strong> et même <strong>C++</strong> depuis la version 11 !
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Notre service est quasiment finit, mais il manque une partie importante du code : l&#8217;instantiation de la classe <em>Http</em>. Pour le faire on va se dispenser du mot clé <strong>new</strong> car Angular utilise depuis toujours un concept fort et structurant : l&#8217;injection de dépendances. Je ne vais pas trop insister sur l&#8217;injection, cela mériterait un article entier sur le sujet (j&#8217;aborderais surement le sujet dans un billet, en attendant si vous êtes intéressé vous trouverez des informations <a href="https://en.wikipedia.org/wiki/Dependency_injection">ici</a>, <a href="https://en.wikipedia.org/wiki/Dependency_inversion_principle">ici</a> ou encore <a href="https://en.wikipedia.org/wiki/Inversion_of_control">ici</a>)</p>
</div>
<div class="paragraph">
<p>Deux points sont important à noter niveau dépendances sur ce service :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>La classe <em>Http</em> est une dépendance nécessaire au bon fonctionnement du service.</p>
</li>
<li>
<p>Le service en lui-même est une dépendance qu&#8217;il faudra injecter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Il va donc falloir utiliser des annotations pour gérer ces deux points.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Les annotations sont des méta-données qui servent à décorer une classe, un paramètre ou encore une méthode. Cela permet de donner des aspects sans avoir à implémenter du code ou de la configuration sans dépendance à un fichier.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Commencez par importer les annotations dédiés à l&#8217;injection :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">import {Injectable, Inject} from 'angular2/angular2';</code></pre>
</div>
</div>
<div class="paragraph">
<p>L&#8217;annotation <em>Injectable</em> va permettre de décorer la classe pour qu&#8217;elle puisse être injectée, <em>Inject</em> quant à lui permet de préciser l&#8217;injection direct d&#8217;une dépendance. Les annotations doivent être préfixées par un <strong>@</strong> et précédées l'élément décoré. Pour rendre la classe injectable il faut donc écrire :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">@Injectable()
export class UserService {
	...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Et pour injecter une instance d'<em>Http</em>, il faut le faire via le constructeur de la classe en décorant le paramètre d&#8217;entrée :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">constructor(@Inject(Http) http: Http){
	this._http = http;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A ce stade le service utilisateur est terminé. Si vous avez bien suivi toutes les étapes vous devriez avoir le code suivant :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">/// &lt;reference path='../../../../typings/tsd.d.ts' /&gt;

import {User} from './user';
import {Http} from 'angular2/http';
import {Injectable, Inject} from 'angular2/angular2';

@Injectable()
export class UserService {

    private _http: Http;

    constructor(@Inject(Http) http: Http){
        this._http = http;
    }

    public getUsers() {
        return this._http
            .get('http://localhost:3000/user')
            .map((res) =&gt; { return &lt;User[]&gt;res.json(); });
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Vous avez surement fait attention à la ligne en commentaire tout en haut du code source. C&#8217;est la référence au fichier de définitions qui permettent à votre <strong>IDE</strong> de faire l&#8217;auto-complétion en TypeScript. Ici la CLI tsd à centraliser l&#8217;ensemble des références dans un fichier <em>tsd.d.ts</em>. Il vous suffit ensuite d&#8217;ajouter cette référence dans n&#8217;importe quel fichier TypeScript pour accéder à l&#8217;ensemble de la complétion. C&#8217;est plutôt pratique, mais attention à ne pas mélanger l&#8217;utilisation des bibliothèques clients et serveurs dans votre code quand vous faites du node.js !
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_les_composants">Les composants</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Angular2 a enterré plusieurs concepts important du framework. Les deux principaux pour moi sont le <strong>Scope</strong> et le <strong>Controller</strong>. Il est possible de trouver une explication logique à cette suppression. Quant on développait un contrôleur Angular avec la première version il y avait une ambiguïté entre les pattern <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">MVC</a> et <a href="https://en.wikipedia.org/wiki/Model_View_ViewModel">MVVM</a>. D&#8217;un côté le contrôleur traitait des actions mais d&#8217;un autre on utilisait le Scope pour faire le <strong>binding two way</strong>. Malheureusement le mélange de ces deux concepts créer pas mal de confusion et même s&#8217;il est possible de les faire cohabiter, le mieux reste encore de les séparer clairement. Dans Angular2 plus d&#8217;ambiguïté, nous avons à disposition les <strong>Components</strong> et on peut dire qu&#8217;il fonctionne comme des ViewModels. Certains ne seront peut-être pas d&#8217;accord avec mon analyse, mais on va dire que ce point de vue n&#8217;engage que moi ;)</p>
</div>
<div class="paragraph">
<p>Afin de rester bien organiser, ajoutez un répertoire <em>components</em> toujours dans :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">public/javascripts/app</code></pre>
</div>
</div>
<div class="paragraph">
<p>et ajoutez y un fichier <em>user.component.ts</em> et un <em>user.component.html</em>. Le fichier .html correspondra au template utilisé par le compostant. L&#8217;idée est de partir sur une liste d&#8217;utilisateur. Une simple boucle for fera la mise en forme. Voici le code du template :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;div&gt;
    &lt;h2&gt;User list&lt;/h2&gt;
    &lt;ul&gt;
        &lt;li *ng-for="#user of users"&gt;
            {{user.firstName}} {{user.lastName}}
        &lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pour le composant aura pour structure le code suivant :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">export class UserComponent {

    constructor(){

    }

    getUsers(){

    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Afin que le template puisse fonctionner il faut que le composant dispose d&#8217;un attribut <em>public users</em> de type <em>User[]</em> (Le template itère une collection). De plus, le service devra être utilisé pour obtenir les données. Avant l&#8217;export de la classe il faut donc importer le type <em>User</em> et <em>UserService</em> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">import {User} from '../services/user';
import {UserService} from '../services/user.service';</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ensuite, ajoutez avant le constructeur l&#8217;attribut public correspondant au tableau d&#8217;utilisateur et celui privée pour utiliser le service utilisateur :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">public users: User[];
private _userService: UserService;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Dans <em>getUser()</em> il est nécessaire de faire un appel au service pour obtenir les données. Pour cela il faut souscrire au résultat de l&#8217;appel et assigner la valeur de retour à l&#8217;attribut <em>users</em> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">getUsers(){
    this._userService.getUsers().subscribe((users) =&gt; {
        this.users = users;
    });
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>La logique du composant est maintenant opérationnelle, mais en l'état il ne peut pas fonctionner. Il faut le décorer avec deux annotations : <em>@Component</em> et <em>@View</em>. La première va nous permettre de définir le <strong>selector</strong> (le tag qui permet à angular d&#8217;identifier le composant à utiliser dans une vue) et les services à utiliser. La seconde apporte des informations sur le template et les <strong>directives</strong> à utiliser par le composant.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Les directives n&#8217;ont pas disparu dans Angular2 et elle permettent toujours de manipuler le DOM.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Avant d&#8217;ajouter les deux annotations sur la classe il faut les importer :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">import {Component, View, NgFor} from 'angular2/angular2';</code></pre>
</div>
</div>
<div class="paragraph">
<p>Vous avez dû remarquer qu&#8217;un import est fait aussi pour <em>NgFor</em>. En effet, une boucle est utilisée dans le template et il est nécessaire d&#8217;inclure la référence de la directive pour que cela fonctionne. Il faut ensuite préciser dans l&#8217;annotation le template et l&#8217;ensemble des directives utilisées par celui-ci :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">@View({
    templateUrl: 'javascripts/app/components/user.component.html',
    directives: [NgFor]
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pour l&#8217;annotation <em>Component</em>, il faut spécifier le selector et les dépendances :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">@Component({
    selector: 'users',
    providers:[UserService]
})</code></pre>
</div>
</div>
<div class="paragraph">
<p>Il ne manque plus que le constructeur du composant :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">constructor(userService: UserService){
	this._userService = userService;
	this.users = this.getUsers();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Il n&#8217;est pas nécessaire de préciser que <em>UserService</em> est une dépendance à injecter, Angular2 est capable de le faire automatiquement dans notre cas. La dépendance est explicitement décrite dans l&#8217;annotation <em>Component</em> et le service est décoré par <em>Injectable</em>.</p>
</div>
<div class="paragraph">
<p>Notre composant est maintenant terminée. Si vous avez suivi toutes les étapes vous devriez avoir l&#8217;ensemble du code suivant :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">import {Component, View, NgFor} from 'angular2/angular2';
import {UserService} from '../services/user.service';
import {User} from '../services/user';

@Component({
    selector: 'users',
    providers:[UserService]
})
@View({
    templateUrl: 'javascripts/app/components/user.component.html',
    directives: [NgFor]
})
export class UserComponent {
    public users: User[];
    private _userService: UserService;

    constructor(userService: UserService){
    	this._userService = userService;
        this.users = this.getUsers();
    }

    getUsers(){
        this._userService.getUsers().subscribe((users) =&gt; {
            this.users = users;
        });
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bootstrapping">Bootstrapping</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Depuis le début de l&#8217;article il y a eu pas mal de code, mais rien n&#8217;est encore exéctuable. Il est donc temps de passer aux montages des différents élements pour avoir un peu de visuel. Dans cette partie je vais vous parler de certains éléments qui ne sont pas du tout finalisés dans Angular2. Je vais donc aller à l&#8217;essentiel, sans trop insister !</p>
</div>
<div class="paragraph">
<p>Pour afficher la liste des utilisateurs, je vous propose d&#8217;afficher un lien dans un composant parent afin de manipuler le <strong>router</strong>. Pour commencer, ajoutez les fichier <em>app.html</em>, <em>app.ts</em>, <em>boostrap.ts</em> et <em>route.config.ts</em> à la racine du répertoire :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">public/javascripts/app</code></pre>
</div>
</div>
<div class="paragraph">
<p>Le code du fichier route.config.ts est le suivant :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">import {UserComponent} from './components/user.component';

export var Routes = {
    userList : {
        path: '/userList',
        as: 'UserList',
        component: UserComponent
    }
};

export const APP_ROUTES = Object.keys(Routes).map(r =&gt; Routes[r]);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Le router va être réécrit prochainement par l'équipe d&#8217;Angular, donc inutile de s&#8217;attarder trop sur ce code car, il risque de ne plus être valide dans les prochaines versions. Grosso modo il permet de définir un composant sur le path <em>"/userList"</em> qui a pour alias le nom <em>UserList</em>. Le router est ensuite utilisé dans le template <em>app.html</em> :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">&lt;a [router-link]="['/' + routes.userList.as]"&gt;List all users&lt;/a&gt;
&lt;router-outlet&gt;&lt;/router-outlet&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ici <em>router-outlet</em> joue le rôle d&#8217;un conteneur pour le composant qui va être chargé lors du clic sur le lien. Le composant <em>app.ts</em> joue uniquement le rôle de parent. Dans la class <em>App</em> les actions qui sont faites permettent de monter la mécanique du router :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">/// &lt;reference path='../../../typings/tsd.d.ts' /&gt;

import {Component, View} from 'angular2/angular2';
import {RouteConfig, ROUTER_DIRECTIVES} from 'angular2/router';
import {Routes, APP_ROUTES} from './route.config';

@Component({
    selector: 'app'
})
@View({
    templateUrl: 'javascripts/app/app.html',
    directives: [ROUTER_DIRECTIVES]
})
@RouteConfig(APP_ROUTES)
export class App {
    public routes = Routes;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pour finir l&#8217;exemple, il faut démarrer l&#8217;ensemble de l&#8217;application avec le fichier <em>boostrap.ts</em>. Ajoutez y le code suivant :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">import {bootstrap} from 'angular2/angular2';
import {ROUTER_PROVIDERS} from 'angular2/router';
import {App} from './app';
import {HTTP_PROVIDERS} from 'angular2/http';

bootstrap(App, [HTTP_PROVIDERS, ROUTER_PROVIDERS]);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Une fois ces quatre fichiers alimentés, le code source est complet. Il ne reste plus qu'à compiler l&#8217;ensemble des fichiers TypeScript en tapant dans votre terminal la commande :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">$ tsc</code></pre>
</div>
</div>
<div class="paragraph">
<p>Pour finir, démarrez l&#8217;Api Rest avec npm :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">$ npm start</code></pre>
</div>
</div>
<div class="paragraph">
<p>L&#8217;application est disponible via l&#8217;url : <a href="http://localhost:3000" class="bare">http://localhost:3000</a>.
En cliquant sur le lien <em>List all users</em> vous devriez à présent voir la liste des utilisateurs renvoyés par l&#8217;Api Rest :)</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Pour les plus curieux d&#8217;entre vous qui se demande comment les fichiers javascript sont chargés, je vous conseille de jeter un coup d&#8217;oeil à l'<em>index.html</em> contenu dans le répertorie <em>Views</em>. Comme vous allez le voir c&#8217;est <strong>system.js</strong> qui est utilisé pour charger et démarrer l&#8217;ensemble de l&#8217;application. J&#8217;ai volontairement écarté cette partie du code dans l&#8217;article pour me concentrer uniquement sur Angular2.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dans cet exemple j&#8217;ai voulu vous présenter deux fondements d&#8217;Angular2 : les <strong>Services</strong> et les <strong>Composants</strong>. Ces deux éléments représentent les bases de la prochaine version et elles sont maintenant assez matures pour qu&#8217;on puisse les essayer. Il y a fort à parier que dans les prochaines semaines la structure de la librairie change encore.</p>
</div>
<div class="paragraph">
<p>Quoi qu&#8217;il en soit l'état actuel du code est suffisant pour ce faire un avis. Il est clair qu&#8217;Angular2 a changé en profondeur et à renier certains de ses concepts clés. A titre personnel je trouve cette version très intéressante car, elle est mieux structurée à mon goût et ne mélange plus certains concept qui cohabitait très moyennement ensemble. Maintenant il y a un point qui restera obscure encore quelques mois : Est-ce que la communauté va suivre ? Le succès de la première version est venu du nombre conséquent de développeurs utilisant Angular. La seconde version connaitra-t-elle le même engouement ? Il faudra attendre sa sortie en Release pour le savoir !</p>
</div>
</div>
</div>
        </section>

        <footer class="post-footer">


            <figure class="author-image">
                <a class="img" href="" style="background-image: url(https://avatars.githubusercontent.com/u/3357643?v=3)"><span class="hidden">Sylvain PONTOREAU's Picture</span></a>
            </figure>

            <section class="author">
                <h4><a href="">Sylvain PONTOREAU</a></h4>

                    <p>Read <a href="">more posts</a> by this author.</p>
                <div class="author-meta">
                    <span class="author-location icon-location">Paris</span>
                    <span class="author-link icon-link"><a href="sylvain.pontoreau.com">sylvain.pontoreau.com</a></span>
                </div>
            </section>


            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="https://twitter.com/share?text=Introduction%20%C3%A0%20Angular2&amp;url=http://sylvain.pontoreau.com/2015/11/16/Introduction-a-Angular2.html"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://sylvain.pontoreau.com/2015/11/16/Introduction-a-Angular2.html"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://sylvain.pontoreau.com/2015/11/16/Introduction-a-Angular2.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

        </footer>


        <section class="post-comments">
          <div id="disqus_thread"></div>
          <script type="text/javascript">
          var disqus_shortname = 'sylvainpontoreau'; // required: replace example with your forum shortname
          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
          </script>
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </section>


    </article>

</main>



    <footer class="site-footer clearfix">
        <section class="copyright"><a href="http://sylvain.pontoreau.com">Sylvain PONTOREAU</a> &copy; 2016</section>
        <section class="poweredby">Proudly published with <a href="http://hubpress.io">HubPress</a></section>
    </footer>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();      
      </script>

    <script type="text/javascript" src="//sylvain.pontoreau.com/themes/Casper/assets/js/jquery.fitvids.js?v=1.0.0"></script>
    <script type="text/javascript" src="//sylvain.pontoreau.com/themes/Casper/assets/js/index.js?v=1.0.0"></script>

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-57055345-1', 'auto');
    ga('send', 'pageview');

    </script>
</body>
</html>
