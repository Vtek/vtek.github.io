= Introduction à Angular2 !
:hp-image: introduction-a-angular2.png

:hp-tags: Angular2, TypeScript


L'annonce d'*Angular2* l'année dernière à la _ng-europe_ à fait couler beaucoup d'encre. Cette nouvelle version change complétement le framework, a tel point que l'on peut se demander si la librairie ne devrait pas s'appeller autrement. Dernièrement j'ai eu un peu de temps pour faire de la veille et ça faisait un moment que je voulais voir ce que cette version donne. Je vous propose donc un petit un petit exemple !


== Rest API

Avant de gagner du temps, j'ai créé un Repo sur *Github* contenant une API Rest très simple à utiliser. Commencez par récupérer le projet ici :

https://github.com/Vtek/BlogIntroductionAngular2

L'Api tourne avec *node.js* (vous trouverez le runtime https://nodejs.org[ici]), et nécessite la CLI *TypeScript*. Il faut l'installer globalement via npm :

----
$ npm install -g typescript
----

TypeScript utilise des fichiers de définitions. Pour les gérer éfficacement j'utilise la CLI *tsd* :

----
$ npm install -g tsd
----

Pour compiler les fichiers TypeScript, mettez vous à la racine du projet et tapez les trois commandes suivantes :

----
$ npm install
$ tsd install
$ tsc
----

Si tout va bien l'API démarre via la commande :

----
$ npm start
----

Le serveur écoute sur le port 3000 et si vous attaquez l'url http://localhost:3000/user, vous devriez obtenir le JSON suivant en réponse :

++++
<iframe width="100%" height="150" src="//jsfiddle.net/Vtek/5vc4fvgx/embedded/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>
++++

== Angular2 et les services

Si vous avez déjà fait de l'Angular, vous connaissez très certainement les _services_. C'est une des notions qui a été conservé dans Angular2 et nous allons en utiliser pour consommer notre Rest API. Pour commencer, ajoutez un répertoire services dans :
----
public/javascripts/app
----
et ajoutez y un fichier _user.ts_ et un _user.service.ts_. Le fichier user.ts contient le code suivant :

++++
<iframe width="100%" height="120" src="//jsfiddle.net/Vtek/m5hp41ot/embedded/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>
++++

Cette classe définit un object de données correspondant au JSON qui est renvoyé par l'API. Le fichier _user.service.ts_ aura pour structure :

++++
<iframe width="100%" height="200" src="//jsfiddle.net/Vtek/s2jgLa0v/embedded/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>
++++

La méthode _getUser()_ permettera d'obtenir les données. Pour consommer l'API Rest il existe le module *Http*. Celui ci vous permez d'attaquer les services web via les principaux verbes Http (Get, Post, Put, Delete...). Pour l'utiliser il faut au préalable en connaitre la définition. Dans votre code source, avant l'export de la classe _UserService_ il faut ajouter un import du module :

++++
<iframe width="100%" height="80" src="//jsfiddle.net/Vtek/aco04tn1/embedded/" allowfullscreen="allowfullscreen" frameborder="0"></iframe>
++++

